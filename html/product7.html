<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="main.css">
    <script src="script.js"></script>
    <script src="product_scrpt.js"></script>
    <link rel="icon" type="image/png" sizes="14x22" href="Screenshot 2025-08-12 142558.png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playwrite+AU+QLD:wght@100..400&display=swap" rel="stylesheet">
    <title>Orion Crystals</title>
</head>
<body>
    <div class="header" style="display: flex; align-items: center; justify-content: center; gap: 24px; position: relative;">
    <div class="dropdown" style="position: absolute; left: 0;">
      <div class="menu-icon" onclick="toggleDropdown(this)">
        <span></span>
        <span></span>
        <span></span>
      </div>
      <div class="dropdown-content" id="dropdownMenu">
        <a href="index.html">Home</a>
        <a href="products.html">Products</a>
        <a href="constructor.html">Constructor</a>
        <a href="about_us.html">About Us</a>
      </div>
    </div>
        <h1 class="header-text" style="margin: 0;">Orion Crystals</h1>
        <div class="login-mini-banner" style="position: absolute; right: 32px; top: 50%; transform: translateY(-50%);">
          <a href="login.html" class="login-icon-container">
            <div class="login-icon">
              <svg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                <circle cx="20" cy="14" r="7" fill="#fafafa" stroke="#111" stroke-width="2"/>
                <rect x="8" y="26" width="24" height="10" rx="8" fill="#fafafa" stroke="#111" stroke-width="2"/>
              </svg>
            </div>
          </a>
        </div>
    </div>
    <div class="product-detail-container">
    <div class="product-detail-left">
      <img src="ChatGPT Image 2025. aug. 14. 12_52_30.png" alt="Crystal Amethyst" class="product-detail-img">
    </div>
    <div class="product-detail-right">
      <div class="product-detail-desc7">Industrial-chic iron plating with crimson inlays, a salute to fire, power, and precision.</div>
      <h2 class="product-detail-title7">Rammstein Bracelet</h2>

      <!-- SIZE SELECTOR (product7) -->
      <label class="size-label" for="size-select-7" style="display:block;margin:8px 0 6px;font-weight:600;">Size (cm)</label>
      <div class="size-select-wrap">
        <select id="size-select-7" class="size-select" aria-label="Choose bracelet size">
          <option value="" disabled selected>Choose size</option>
          <option value="16">16 cm</option>
          <option value="17">17 cm</option>
          <option value="18">18 cm</option>
          <option value="19">19 cm</option>
          <option value="20">20 cm</option>
          <option value="21">21 cm</option>
          <option value="22">22 cm</option>
          <option value="23">23 cm</option>
        </select>
      </div>

      <div class="product-detail-price">4 700 HUF</div>

      <div class="product-detail-quantity">
        <button class="qty-btn" onclick="decreaseQty7()">-</button>
        <span id="qty-value-7">1</span>
        <button class="qty-btn" onclick="increaseQty7()">+</button>
      </div>

      <button class="buy-btn" id="buy-7">Add to Checkout</button>

      <div class="product-detail-badge">
        <span class="banner-text">LAST PIECE! LAST PIECE! LAST PIECE!</span>
      </div>
    </div>

  <!-- popup already present later in the file; keep it. -->
  <script>
  // Product7: local qty + add-to-cart (size-aware). Idempotent and safe.
  (function () {
    // expose minimal global qty helpers to keep existing inline onclick working (id-specific)
    window.decreaseQty7 = function () {
      var el = document.getElementById('qty-value-7');
      var v = Math.max(1, parseInt(el?.textContent || '1', 10));
      if (v > 1) v--;
      if (el) el.textContent = v;
    };
    window.increaseQty7 = function () {
      var el = document.getElementById('qty-value-7');
      var v = Math.max(1, parseInt(el?.textContent || '1', 10));
      v++;
      if (el) el.textContent = v;
    };

    function readCart(){ try{ return JSON.parse(localStorage.getItem('checkoutCart')||'[]'); }catch(e){ return []; } }
    function writeCart(c){ try{ localStorage.setItem('checkoutCart', JSON.stringify(c)); }catch(e){} }

    function safeText(sel){ return (document.querySelector(sel)?.textContent || '').trim(); }

    document.addEventListener('DOMContentLoaded', function () {
      // DOM refs
      var buyBtn = document.getElementById('buy-7');
      var popup = document.getElementById('cart-popup');
      var summary = document.getElementById('cart-popup-summary') || null;
      var stay = document.getElementById('stay-shopping-btn');
      var go = document.getElementById('go-checkout-btn');
      var sizeSel = document.getElementById('size-select-7');

      // defensive: ensure size options exist (if someone removed them)
      if (sizeSel && sizeSel.children.length <= 1) {
        for (var s = 16; s <= 23; s++) {
          var o = document.createElement('option'); o.value = String(s); o.textContent = s + ' cm'; sizeSel.appendChild(o);
        }
      }

      function getQty() { return Math.max(1, parseInt(document.getElementById('qty-value-7')?.textContent || '1', 10)); }

      function showPopup(text) {
        if (!popup) return;
        if (summary) summary.textContent = text || '';
        popup.style.display = 'flex';
        popup.setAttribute('aria-hidden','false');
        document.documentElement.style.overflow = 'hidden';
        (stay || go)?.focus?.();
      }
      function hidePopup() {
        if (!popup) return;
        popup.style.display = 'none';
        popup.setAttribute('aria-hidden','true');
        document.documentElement.style.overflow = '';
      }

      buyBtn && buyBtn.addEventListener('click', function () {
        var name = safeText('.product-detail-title7') || 'Rammstein Bracelet';
        var priceText = safeText('.product-detail-price') || '0';
        var price = parseInt(String(priceText).replace(/[^\d]/g,''), 10) || 0;
        var img = document.querySelector('.product-detail-img')?.getAttribute('src') || '';
        var qty = getQty();
        var size = sizeSel ? sizeSel.value : '';

        if (sizeSel && !size) {
          sizeSel.focus();
          sizeSel.classList.add('size-select-error');
          setTimeout(function(){ sizeSel.classList.remove('size-select-error'); }, 700);
          return;
        }

        var cart = readCart();
        var idx = cart.findIndex(function(it){ return it.id === 'product7' && String(it.size) === String(size); });
        if (idx >= 0) cart[idx].qty = (cart[idx].qty || 0) + qty;
        else cart.push({ id: 'product7', name: name, price: price, img: img, qty: qty, size: size });
        writeCart(cart);

        showPopup(name + ' — ' + (size ? (size + ' cm') : '—') + ' × ' + qty);
      });

      stay && (stay.onclick = hidePopup);
      go && (go.onclick = function(){ window.location.href = 'checkout.html'; });

      // close on overlay click or Esc
      if (popup) {
        popup.addEventListener('click', function(e){ if (e.target === popup) hidePopup(); });
      }
      document.addEventListener('keydown', function(e){ if ((popup?.style.display === 'flex') && e.key === 'Escape') hidePopup(); });
    });
  })();
  </script>
</div>
<div id="cart-popup" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.35); z-index:999; align-items:center; justify-content:center;">
  <div style="background:#fff; color:#111; border-radius:16px; padding:32px 40px; box-shadow:0 8px 32px rgba(44,62,80,0.18); text-align:center;">
    <div style="font-size:1.3em; margin-bottom:18px;">Item added to cart!</div>
    <button class="cart-popup-btn" id="stay-shopping-btn">Stay shopping</button>
    <button class="cart-popup-btn" id="go-checkout-btn">Go to checkout</button>
  </div>
</div>
<script>
function addToCheckout() {
  var name = document.querySelector('.product-detail-title1, .product-detail-title2, .product-detail-title3, .product-detail-title4, .product-detail-title5, .product-detail-title6, .product-detail-title7, .product-detail-title8, .product-detail-title9, .product-detail-title10, .product-detail-title11, .product-detail-title12')?.textContent || 'Bracelet';
  var priceText = document.querySelector('.product-detail-price')?.textContent || '0 HUF';
  var price = parseInt(priceText.replace(/[^\d]/g, ''));
  var img = document.querySelector('.product-detail-img')?.getAttribute('src') || '';
  var qty = parseInt(document.getElementById('qty-value')?.textContent) || 1;
  var cart = JSON.parse(localStorage.getItem('checkoutCart') || '[]');
  var idx = cart.findIndex(item => item.name === name);
  if (idx >= 0) {
    cart[idx].qty += qty;
  } else {
    cart.push({ name, price, img, qty });
  }
  localStorage.setItem('checkoutCart', JSON.stringify(cart));
  document.getElementById('cart-popup').style.display = 'flex';
}

document.addEventListener('DOMContentLoaded', function() {
  document.getElementById('stay-shopping-btn').onclick = function() {
    document.getElementById('cart-popup').style.display = 'none';
  };
  document.getElementById('go-checkout-btn').onclick = function() {
    window.location.href = 'checkout.html';
  };
});
</script>
    <footer class="footer" style="display: flex; align-items: center; justify-content: center; gap: 18px;">
        <p style="margin: 0;">&copy; 2025 Orion Crystals. All rights reserved.</p>
        <span style="margin-left: 24px; font-weight: 500;">We support</span>
        <img src="https://www.paypalobjects.com/webstatic/icon/pp258.png" alt="PayPal" style="height: 28px; margin-left: 8px;">
        <img src="https://simplepay.hu/wp-content/themes/simplepay_new/images/logo-color2.svg" alt="SimplePay" style="height: 28px; margin-left: 8px;">
    </footer>
</body>
</html>
